window.CatarseAnalytics=window.CatarseAnalytics||function(){function e(){var e=window.location,t=e.origin||e.protocol+"//"+e.hostname;return{referrer:document.referrer||undefined,url:e.href,protocol:e.protocol.substr(0,e.protocol.length-1),hostname:e.hostname,domain:t,pathname:e.pathname||e.href.substr(t.length).replace(/[\?\#].*$/,""),userAgent:"undefined"!=typeof navigator?navigator.userAgent:undefined,hash:e.hash.replace(/^\#/,""),query:function(){if(e.search)try{return e.search.replace(/^\?/,"").split("&").reduce(function(e,t){var r=t.split("=").map(function(e){return decodeURIComponent(e.replace("+"," "))});return e[r[0]]=r[1],e},{})}catch(t){return e.search}}()}}function t(){if(window.CatarseAnalyticsURL)return window.CatarseAnalyticsURL;if(c)return c;var e=document.getElementById("api-host");return c=e&&e.getAttribute("content"),c&&(c+="/rpc/track"),c}function r(){if(s)return s;var e=document.getElementsByTagName("body"),t=e&&e[0]&&e[0].getAttribute("data-user");if(t)try{return s=JSON.parse(t)}catch(e){console.error("[CatarseAnalytics._getUser] error parsing data "+JSON.stringify(t),e)}}function n(){if(u)return u;var e=document.getElementById("project-show-root")||document.getElementById("project-header"),t=e&&(e.getAttribute("data-parameters")||e.getAttribute("data-stats"));if(t)try{return u=JSON.parse(t)}catch(e){console.error("[CatarseAnalytics._getProject] error parsing data "+JSON.stringify(t),e)}}function a(a,o,i){if(a)try{var c=a.project||n(),s=a.user||r(),u=window.ga,d="function"==typeof u&&u.getAll&&u.getAll()&&u.getAll()[0]||null;i=i||"function"!=typeof u;var l=a.extraData&&"object"==typeof a.extraData?JSON.parse(JSON.stringify(a.extraData)):{};l.ctrse_sid=f,l.origin=p,l.category=a.cat,l.action=a.act,l.label=a.lbl,l.value=a.val,l.request=e(),s&&s.user_id&&(l.user={id:s.user_id,contributions:s.contributions,published_projects:s.published_projects}),c&&(c.id||c.project_id)&&(l.project={id:c.id||c.project_id,user_id:c.user_id||c.project_user_id,category_id:c.category_id,state:c.address&&c.address.state_acronym,city:c.address&&c.address.city}),d&&(l.ga={clientId:d.get("clientId")});try{var g=t();if(g){var h={event:l};m({url:g,body:JSON.stringify(h),headers:{"Content-Type":"application/json; charset=utf-8"}},function(e,t,r){200!==e&&console.error(e,t,r)})}}catch(e){console.error("[CatarseAnalytics.event] error:",e)}i||void 0===u||u("send","event",a.cat,a.act,a.lbl,a.val,{nonInteraction:a.nonInteraction!==!1,transport:"beacon"})}catch(e){console.error("[CatarseAnalytics.event] error:",e)}o&&o()}function o(e){g&&clearTimeout(g),g=setTimeout(function(){a({cat:"navigation",act:"pageview",lbl:location.pathname},null,!0),e||"undefined"==typeof ga||(ga("set","page",location.pathname),ga("send","pageview",location.pathname))})}function i(e,t,r,n,a,o){try{"function"==typeof ga&&(ga("ecommerce:addTransaction",{id:e,revenue:a,tax:o,current:"BRL"}),ga("ecommerce:addItem",{id:e,name:t,sku:r,category:n,price:a,quantity:"1"}),ga("ecommerce:send"))}catch(e){console.error("[CatarseAnalytics.checkout]",e)}}var c,s,u,d={set:function(e,t,r,n,a,o){var i=new Date,c="",s=typeof t,u="",d="";if(n=n||"/",r&&(i.setTime(i.getTime()+24*r*60*60*1e3),c="; expires="+i.toUTCString()),"object"===s&&"undefined"!==s){if(!("JSON"in window))throw"Bummer, your browser doesn't support JSON parsing.";u=encodeURIComponent(JSON.stringify({v:t}))}else u=encodeURIComponent(t);a&&(d="; secure"),o=o?"; domain="+encodeURIComponent(o):"",document.cookie=e+"="+u+c+"; path="+n+d+o},get:function(e){for(var t=e+"=",r=document.cookie.split(";"),n="",a={},o=0;o<r.length;o++){for(var i=r[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t)){if(n=decodeURIComponent(i.substring(t.length,i.length)),"{"==n.substring(0,1))try{if("v"in(a=JSON.parse(n)))return a.v}catch(e){return n}return"undefined"==n?undefined:n}}return null},remove:function(e){this.set(e,"",-1)},increment:function(e,t){var r=this.get(e)||0;this.set(e,parseInt(r,10)+1,t)},decrement:function(e,t){var r=this.get(e)||0;this.set(e,parseInt(r,10)-1,t)}},m=function(){function e(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new window.ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){}throw new Error("no xmlhttp request able to be created")}function t(e,t,r){e[t]=e[t]||r}return function(r,n){"string"==typeof r&&(r={url:r});var a=r.headers||{},o=r.body,i=r.method||(o?"POST":"GET"),c=r.withCredentials||!1,s=e();s.withCredentials=c,s.onreadystatechange=function(){4==s.readyState&&n(s.status,s.responseText,s)},o&&(t(a,"X-Requested-With","XMLHttpRequest"),t(a,"Content-Type","application/json; charset=utf-8")),s.open(i,r.url,!0);for(var u in a)s.setRequestHeader(u,a[u]);s.send(o)}}(),f=function(e){var t=e.get("ctrse_sid");if(!t){t=function(){for(var e=[],t=0;15>=t;t++)e[t]=t.toString(16);return function(){for(var t="",r=1;36>=r;r++)t+=9===r||14===r||19===r||24===r?"-":15===r?4:20===r?e[4*Math.random()|8]:e[15*Math.random()|0];return t}}()()}return e.set("ctrse_sid",t,180,"/",!1,".grasruts.com"),t}(d),l={};try{var p=function(e,t){try{var r=JSON.parse(t.get("ctrse_origin")||null)||{createdAt:new Date}}catch(e){r={createdAt:new Date}}if(e.referrer&&/^https?:\/\/([^\\\/]+\.)?grasruts\.com/.test(e.referrer))r.ref=e.query&&e.query.ref||r.ref;else if(e.referrer||!r._time||(new Date).getTime()-r._time>6e5){var n=e.referrer&&e.referrer.match(/https?:\/\/([^\/\?#]+)/),a=n&&n[1]||undefined,o=e.query;o&&["utm_campaign","utm_source","utm_medium","utm_content","utm_term"].some(function(e){return!!o[e]})?(r.domain=a,r.campaign=o.utm_campaign,r.source=o.utm_source,r.medium=o.utm_medium,r.content=o.utm_content,r.term=o.utm_term):a&&!["domain","utm_campaign","utm_source","utm_medium","utm_content","utm_term"].some(function(e){return!!r[e]})&&(r.domain=a),!r.campaign&&o&&o.ref&&(r.campaign=o.ref)}return r._time=(new Date).getTime(),t.set("ctrse_origin",JSON.stringify(r),180,"/",!1,".grasruts.com"),r}(e(),d)}catch(e){console.error("[CatarseAnalytics] error",e)}var g;return o(!0),{origin:p,event:a,pageView:o,oneTimeEvent:function(e,t){if(!e)return t;try{if(!e.cat&&!e.act)throw new Error("Should inform cat or act");var r=e.cat&&e.act?e.cat+"_"+e.act:e.cat||e.act;l[r]||(l[r]=!0,a(e,t))}catch(e){console.error("[CatarseAnalytics.oneTimeEvent] error:",e)}},checkout:i}}();